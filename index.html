<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Photobooth</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
  .camera-box {
    width: 500px;
    height: 500px;
    position: relative;
  }

  video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
</style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center bg-pink-100 gap-4">

<h1 class="text-3xl font-light">photobooth</h1>

<!-- CAMERA + FRAME -->
<div class="camera-box">
  <video id="video" autoplay playsinline></video>

  <!-- TIMER -->
  <div id="countdown"
    class="absolute inset-0 hidden flex items-center justify-center
           text-white text-7xl font-bold bg-black/40 z-20">
  </div>

  <!-- FRAME -->
  <img src="frame.png"
       class="absolute inset-0 w-full h-full pointer-events-none z-30">
</div>

<!-- CONTROLS -->
<div class="flex gap-3 mt-2">
  <input id="timer" type="number" placeholder="Timer"
         class="border rounded px-3 py-2 w-24 text-center">

  <button id="capture"
          class="bg-blue-500 text-white px-5 py-2 rounded-full">
    Capture
  </button>
</div>

<!-- RESULT -->
<div id="result" class="flex gap-4 mt-6"></div>

<script>
const video = document.getElementById("video");
const captureBtn = document.getElementById("capture");
const timerInput = document.getElementById("timer");
const countdown = document.getElementById("countdown");
const result = document.getElementById("result");

const frame = new Image();
frame.src = "frame.png";

let cameraReady = false;

// CAMERA INIT
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => {
    video.srcObject = stream;
    video.onloadedmetadata = () => {
      cameraReady = true;
    };
  });

captureBtn.onclick = () => {
  if (!cameraReady) return alert("Camera belum siap!");

  let time = parseInt(timerInput.value) || 0;

  if (time > 0) {
    countdown.classList.remove("hidden");
    countdown.textContent = time;

    const interval = setInterval(() => {
      time--;
      countdown.textContent = time;

      if (time <= 0) {
        clearInterval(interval);
        countdown.classList.add("hidden");
        takePhoto();
      }
    }, 1000);
  } else {
    takePhoto();
  }
};

function takePhoto() {
  const canvas = document.createElement("canvas");
  canvas.width = 500;
  canvas.height = 500;

  const ctx = canvas.getContext("2d");

  // CAMERA
  ctx.drawImage(video, 0, 0, 500, 500);

  // FRAME
  ctx.drawImage(frame, 0, 0, 500, 500);

  const img = document.createElement("img");
  img.src = canvas.toDataURL("image/png");
  img.className = "w-40 rounded shadow";

  result.appendChild(img);
}
</script>

</body>
</html>

