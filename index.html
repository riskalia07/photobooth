<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Photobooth</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    video {
      width: 640px;
      height: 480px;
      object-fit: cover;
      border-radius: 1rem;
    }

    #countdown {
      text-shadow: 0 0 15px rgba(0,0,0,0.9);
    }
  </style>
</head>

<body class="flex flex-col items-center justify-center min-h-screen bg-pink-100 gap-6">

  <h1 class="text-4xl font-light">photobooth</h1>

  <!-- CAMERA + FRAME -->
  <div class="relative w-[640px] h-[480px]">
    <!-- CAMERA -->
    <video id="video" autoplay class="absolute inset-0"></video>

    <!-- TIMER -->
    <div id="countdown"
      class="absolute inset-0 hidden flex items-center justify-center
             text-white text-7xl font-bold bg-black/40 rounded-xl z-20">
    </div>

    <!-- FRAME -->
    <img
      src="frame.png"
      class="absolute inset-0 w-full h-full pointer-events-none z-30"
      alt="frame"
    />
  </div>

  <!-- CONTROLS -->
  <div class="flex gap-3">
    <input type="number" id="timer" placeholder="Timer (sec)"
      class="border px-3 py-2 rounded w-32 text-center">

    <button id="capture-btn"
      class="bg-blue-500 text-white px-6 py-2 rounded-full font-semibold">
      Capture
    </button>
  </div>

  <!-- RESULT -->
  <div id="photos" class="flex flex-wrap gap-4 mt-6"></div>

  <script>
    const video = document.getElementById("video");
    const captureBtn = document.getElementById("capture-btn");
    const timerInput = document.getElementById("timer");
    const countdownEl = document.getElementById("countdown");
    const photos = document.getElementById("photos");

    const frameImg = new Image();
    frameImg.src = "frame.png";

    // Camera
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream);

    captureBtn.addEventListener("click", () => {
      let time = parseInt(timerInput.value) || 0;

      if (time > 0) {
        countdownEl.classList.remove("hidden");
        countdownEl.textContent = time;

        const interval = setInterval(() => {
          time--;
          countdownEl.textContent = time;

          if (time <= 0) {
            clearInterval(interval);
            countdownEl.classList.add("hidden");
            capturePhoto();
          }
        }, 1000);
      } else {
        capturePhoto();
      }
    });

    function capturePhoto() {
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");

      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;

      // draw camera
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      // draw frame
      ctx.drawImage(frameImg, 0, 0, canvas.width, canvas.height);

      const img = document.createElement("img");
      img.src = canvas.toDataURL("image/png");
      img.className = "w-40 rounded shadow";

      photos.appendChild(img);
    }
  </script>

</body>
</html>
